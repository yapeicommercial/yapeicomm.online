<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookies Policy ¬∑ Yapei Community</title>
    <!-- Bootstrap 5 + Icons + Animate.css -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
        :root {
            --primary-deep: #0b4b7a;
            --primary-soft: #e2f0fd;
            --accent-gold: #f9b84a;
            --card-radius: 32px;
            --section-bg: #f9fcff;
        }
        body {
            background: #ffffff;
            font-family: 'Inter', 'Segoe UI', Roboto, system-ui, sans-serif;
            color: #1f2f40;
        }
        /* navbar ‚Äì unified */
        .navbar {
            background: linear-gradient(135deg, #0b4b7a 0%, #1f6ca3 100%) !important;
            box-shadow: 0 10px 25px -10px #0a3d61;
        }
        .navbar-brand {
            color: white !important;
            font-weight: 600;
            font-size: 1.6rem;
        }
        .navbar-brand i {
            color: var(--accent-gold);
            margin-right: 8px;
        }
        .navbar-nav .nav-link {
            color: rgba(255,255,255,0.9) !important;
            border-radius: 40px;
            margin: 0 6px;
            padding: 0.5rem 1.2rem !important;
            font-weight: 500;
        }
        .navbar-nav .nav-link.active, .navbar-nav .nav-link:hover {
            background: rgba(255,255,255,0.15);
        }
        /* page header */
        .cookies-header {
            background: linear-gradient(115deg, #ffffff, var(--primary-soft));
            border-bottom: 2px solid rgba(249,184,74,0.2);
            position: relative;
            overflow: hidden;
            padding: 3rem 0;
        }
        .cookies-header::after {
            content: "üç™üç™";
            font-size: 180px;
            position: absolute;
            right: -20px;
            bottom: -40px;
            opacity: 0.1;
            transform: rotate(8deg);
            pointer-events: none;
        }
        .section-title {
            font-weight: 700;
            color: var(--primary-deep);
            margin-bottom: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .section-title i {
            background: var(--primary-soft);
            padding: 12px;
            border-radius: 60px;
            color: var(--primary-deep);
        }
        .policy-card {
            background: white;
            border-radius: var(--card-radius);
            box-shadow: 0 20px 35px -12px rgba(11,75,122,0.12);
            padding: 2rem 2rem 1.5rem 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(0,0,0,0.02);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .policy-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 28px 40px -14px #0b4b7acc;
        }
        .policy-card h3 {
            font-weight: 700;
            font-size: 1.7rem;
            color: var(--primary-deep);
            margin-bottom: 1.2rem;
        }
        .policy-card h3 i {
            color: var(--accent-gold);
            margin-right: 12px;
        }
        /* table styling */
        .policy-table {
            border-radius: 24px;
            overflow: hidden;
            box-shadow: 0 10px 20px -8px rgba(0,0,0,0.05);
        }
        .policy-table thead {
            background: var(--primary-deep);
            color: white;
        }
        .policy-table th {
            font-weight: 600;
            padding: 1rem 1.2rem;
        }
        .policy-table td {
            padding: 1rem 1.2rem;
            vertical-align: middle;
        }
        .policy-table tbody tr:hover {
            background: rgba(249,184,74,0.1);
        }
        .badge-policy {
            background: var(--primary-soft);
            color: var(--primary-deep);
            padding: 0.3rem 1.2rem;
            border-radius: 60px;
            font-weight: 600;
            font-size: 0.9rem;
            margin-right: 0.5rem;
        }
        .last-updated {
            background: #f8f9fa;
            border-radius: 60px;
            padding: 0.5rem 1.8rem;
            display: inline-block;
            font-size: 1rem;
            border: 1px solid rgba(11,75,122,0.1);
        }
        /* cookie config popup */
        .cookie-popup {
            border-radius: 42px !important;
            backdrop-filter: blur(16px);
            background: rgba(255,255,255,0.98) !important;
            border: 1px solid rgba(255,215,120,0.6);
            max-width: 600px;
        }
        .cookie-popup .card-header {
            background: transparent;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            font-weight: 700;
            font-size: 1.6rem;
            padding: 1.5rem 1.5rem 0.5rem;
        }
        .cookie-option {
            background: #fafcff;
            border-radius: 30px;
            padding: 1rem 1.2rem;
            margin-bottom: 0.8rem;
            border: 1px solid rgba(11,75,122,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .cookie-option span {
            font-weight: 600;
            color: var(--primary-deep);
        }
        .cookie-switch {
            width: 50px;
            height: 26px;
            background: #ccc;
            border-radius: 30px;
            display: inline-block;
            position: relative;
            cursor: pointer;
            transition: 0.2s;
        }
        .cookie-switch.active {
            background: var(--accent-gold);
        }
        .cookie-switch::after {
            content: '';
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 22px;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: 0.2s;
            box-shadow: 0 1px 4px rgba(0,0,0,0.2);
        }
        .cookie-switch.active::after {
            left: 26px;
        }
        .popup-icon-bg {
            background: linear-gradient(145deg, #23995e, #1b7e4b);
            width: 80px;
            height: 80px;
            border-radius: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.2rem;
        }
        .modern-footer {
            background: #0b4b7a;
            color: white;
            padding: 2.5rem 0 1.2rem;
            margin-top: 3rem;
        }
        .modern-footer a {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
        }
        .modern-footer a:hover {
            opacity: 0.7;
            text-decoration: underline;
        }
        hr.light {
            background: rgba(255,255,255,0.2);
        }
        .btn-outline-custom {
            border-radius: 60px;
            border: 2px solid var(--primary-deep);
            color: var(--primary-deep);
            font-weight: 600;
            padding: 0.6rem 2rem;
            background: white;
        }
        .btn-outline-custom:hover {
            background: var(--primary-deep);
            color: white;
        }
        .btn-primary-custom {
            background: var(--primary-deep);
            border: none;
            border-radius: 60px;
            padding: 0.7rem 2.2rem;
            font-weight: 600;
            box-shadow: 0 8px 16px -6px #0a4d8c80;
            color: white;
        }
        .btn-primary-custom:hover {
            background: #135f94;
            transform: scale(1.02);
        }
        /* floating chat icon (just for fun) */
        .cookie-favicon {
            font-size: 3rem;
            color: var(--accent-gold);
        }
    </style>
</head>
<body>
    <!-- Navbar (consistent) -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html"><i class="fa-solid fa-people-group"></i> Yapei Community</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-center" id="navbar-links">
                    <li class="nav-item"><a class="nav-link" href="index.html"><i class="fa-solid fa-home me-1"></i>Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="blog.html"><i class="fa-solid fa-newspaper me-1"></i>Blog</a></li>
                    <li class="nav-item"><a class="nav-link" href="about.html"><i class="fa-solid fa-circle-info me-1"></i>About</a></li>
                    <li class="nav-item"><a class="nav-link" href="contact.html"><i class="fa-solid fa-envelope me-1"></i>Contact</a></li>
                    <span id="navbar-user-links" class="d-flex gap-1"></span>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Header specific to cookies policy -->
    <header class="cookies-header text-center">
        <div class="container">
            <span class="badge-policy mb-3 d-inline-block"><i class="fa-regular fa-cookie-bite me-2"></i>Your privacy matters</span>
            <h1 class="display-4 fw-bold" style="color: var(--primary-deep);">Cookies Policy</h1>
            <p class="lead fs-4 mx-auto" style="max-width: 800px;">How we use cookies, why we use them, and how you can control them.</p>
            <div class="last-updated mt-4">
                <i class="fa-regular fa-calendar-check me-2"></i>Last updated: February 2026
            </div>
        </div>
    </header>

    <!-- Main content ‚Äì dedicated cookies policy -->
    <main class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <!-- Introduction card -->
                <div class="policy-card animate__animated animate__fadeInUp">
                    <h3><i class="fa-regular fa-circle-question"></i> What are cookies?</h3>
                    <p class="fs-5">Cookies are small text files stored on your device (computer, tablet, or mobile) when you visit a website. They help the website remember your actions and preferences (such as login, language, and other settings) over a period of time, so you don't have to re-enter them whenever you come back or browse from one page to another.</p>
                    <p class="mb-0">At Yapei Community Online, we use cookies to make your experience smoother, more personalized, and to understand how our community interacts with our content.</p>
                </div>

                <!-- Table: types of cookies we use -->
                <div class="policy-card animate__animated animate__fadeInUp" style="animation-delay: 0.1s;">
                    <h3><i class="fa-regular fa-table"></i> Types of cookies we use</h3>
                    <div class="table-responsive policy-table">
                        <table class="table table-hover align-middle">
                            <thead>
                                <tr>
                                    <th>Cookie category</th>
                                    <th>Provider</th>
                                    <th>Purpose</th>
                                    <th>Duration</th>
                                    <th>Example</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><span class="badge bg-success bg-opacity-25 text-dark p-2"><i class="fa-regular fa-shield me-1"></i> Essential</span></td>
                                    <td>Yapei Community</td>
                                    <td>Authentication, security, load balancing, session management. These are necessary for the website to function.</td>
                                    <td>Session / up to 1 year</td>
                                    <td><code>sessionid</code>, <code>csrftoken</code></td>
                                </tr>
                                <tr>
                                    <td><span class="badge bg-info bg-opacity-25 text-dark p-2"><i class="fa-regular fa-chart-bar me-1"></i> Analytics</span></td>
                                    <td>Google Analytics</td>
                                    <td>Collect anonymized information about how visitors use our site (pages visited, time spent, clicks). Helps us improve content.</td>
                                    <td>26 months</td>
                                    <td><code>_ga</code>, <code>_gid</code></td>
                                </tr>
                                <tr>
                                    <td><span class="badge bg-warning bg-opacity-25 text-dark p-2"><i class="fa-regular fa-star me-1"></i> Preferences</span></td>
                                    <td>Yapei Community</td>
                                    <td>Remember your settings (language, theme, saved preferences) for a personalized experience.</td>
                                    <td>1 year</td>
                                    <td><code>theme_pref</code>, <code>language</code></td>
                                </tr>
                                <tr>
                                    <td><span class="badge bg-secondary bg-opacity-25 text-dark p-2"><i class="fa-regular fa-bullhorn me-1"></i> Marketing</span></td>
                                    <td>None</td>
                                    <td>We do <strong>not</strong> use marketing or advertising cookies. We never sell your data.</td>
                                    <td>‚Äî</td>
                                    <td>‚Äî</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <p class="small text-muted mt-3"><i class="fa-regular fa-circle-info me-1"></i> Essential cookies are always active; other cookies require your consent.</p>
                </div>

                <!-- Why we use cookies (detailed) -->
                <div class="policy-card animate__animated animate__fadeInUp" style="animation-delay: 0.2s;">
                    <h3><i class="fa-regular fa-bullseye"></i> Why we use cookies</h3>
                    <div class="row g-4">
                        <div class="col-md-6">
                            <div class="d-flex gap-3">
                                <span class="bg-soft rounded-circle p-3" style="background: var(--primary-soft);"><i class="fa-regular fa-lock fa-xl" style="color: var(--primary-deep);"></i></span>
                                <div><strong>Security & stability</strong><br>Essential cookies protect your account and prevent fraud.</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="d-flex gap-3">
                                <span class="bg-soft rounded-circle p-3" style="background: var(--primary-soft);"><i class="fa-regular fa-gauge-high fa-xl" style="color: var(--primary-deep);"></i></span>
                                <div><strong>Performance</strong><br>Analytics help us understand what content you love, so we can improve.</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="d-flex gap-3">
                                <span class="bg-soft rounded-circle p-3" style="background: var(--primary-soft);"><i class="fa-regular fa-palette fa-xl" style="color: var(--primary-deep);"></i></span>
                                <div><strong>Personalization</strong><br>Preference cookies remember your theme and language choices.</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="d-flex gap-3">
                                <span class="bg-soft rounded-circle p-3" style="background: var(--primary-soft);"><i class="fa-regular fa-hand-peace fa-xl" style="color: var(--primary-deep);"></i></span>
                                <div><strong>Community features</strong><br>Keep you logged in and remember your interactions.</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Third-party cookies (embedded content) -->
                <div class="policy-card animate__animated animate__fadeInUp" style="animation-delay: 0.3s;">
                    <h3><i class="fa-regular fa-window-maximize"></i> Third-party cookies</h3>
                    <p>We embed content from trusted platforms to enrich your experience. These services may set their own cookies:</p>
                    <ul class="list-styled" style="list-style: none; padding-left: 0;">
                        <li><i class="fa-brands fa-youtube me-2" style="color: #ff0000;"></i> <strong>YouTube:</strong> when you watch a video on our blog, YouTube may set cookies for analytics and preferences.</li>
                        <li><i class="fa-brands fa-x-twitter me-2" style="color: #1DA1F2;"></i> <strong>X (Twitter):</strong> embedded tweets may use cookies for functionality.</li>
                        <li><i class="fa-regular fa-face-smile me-2" style="color: var(--primary-deep);"></i> <strong>Google Fonts & reCAPTCHA:</strong> may set performance/security cookies.</li>
                    </ul>
                    <p class="small">We encourage you to review the privacy policies of these third parties for more information.</p>
                </div>

                <!-- How to control cookies (with config button) -->
                <div class="policy-card animate__animated animate__fadeInUp" style="animation-delay: 0.4s; background: var(--primary-soft);">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h4 class="fw-bold mb-2" style="color: var(--primary-deep);"><i class="fa-regular fa-sliders me-2"></i>Control your cookies</h4>
                            <p class="mb-md-0">You can accept or decline non-essential cookies at any time. Essential cookies are required for the site to work.</p>
                        </div>
                        <div class="col-md-4 text-md-end mt-3 mt-md-0">
                            <button class="btn btn-primary-custom" id="openCookieConfig"><i class="fa-regular fa-gear me-2"></i>Configure cookies</button>
                        </div>
                    </div>
                    <hr class="my-4">
                    <p><i class="fa-regular fa-computer-mouse me-2"></i> You can also manage cookies through your browser settings:</p>
                    <div class="d-flex flex-wrap gap-2">
                        <a href="#" class="btn btn-sm btn-outline-custom" onclick="alert('Guide: Chrome settings ‚Üí privacy ‚Üí cookies'); return false;"><i class="fa-brands fa-chrome"></i> Chrome</a>
                        <a href="#" class="btn btn-sm btn-outline-custom" onclick="alert('Firefox: options ‚Üí privacy & security'); return false;"><i class="fa-brands fa-firefox"></i> Firefox</a>
                        <a href="#" class="btn btn-sm btn-outline-custom" onclick="alert('Safari: preferences ‚Üí privacy'); return false;"><i class="fa-brands fa-safari"></i> Safari</a>
                        <a href="#" class="btn btn-sm btn-outline-custom" onclick="alert('Edge: settings ‚Üí cookies'); return false;"><i class="fa-brands fa-edge"></i> Edge</a>
                    </div>
                </div>

                <!-- Consent and updates -->
                <div class="policy-card animate__animated animate__fadeInUp" style="animation-delay: 0.5s;">
                    <h3><i class="fa-regular fa-clock"></i> Consent & updates</h3>
                    <p>By continuing to use our website, you consent to the use of essential cookies. For non-essential cookies, we ask for your explicit consent via the configuration panel. We may update this Cookies Policy from time to time ‚Äì any changes will be posted on this page.</p>
                    <p class="mb-0"><i class="fa-regular fa-envelope me-2"></i> If you have questions, contact us at <a href="mailto:privacy@yapeionline.org">privacy@yapeionline.org</a>.</p>
                </div>

                <!-- Back to home link -->
                <div class="text-center mt-5">
                    <a href="index.html" class="btn btn-outline-custom px-5 py-3"><i class="fa-solid fa-arrow-left me-2"></i>Return to Home</a>
                </div>
            </div>
        </div>
    </main>

    <!-- COOKIE CONFIGURATION POP-OUT (fully interactive) -->
    <div id="cookieConfigOverlay" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(10,50,80,0.4); backdrop-filter:blur(4px); z-index:1070;"></div>
    <div id="cookieConfigPopup" class="position-fixed top-50 start-50 translate-middle" style="z-index:1071; display:none; min-width:90%; max-width:650px;">
        <div class="card cookie-popup shadow-lg border-0 animate__animated animate__fadeInDown">
            <div class="card-header bg-transparent border-0 text-center">
                <i class="fa-regular fa-cookie-bite fa-3x mb-2" style="color: var(--accent-gold);"></i>
                <h3 class="fw-bold">Cookie preferences</h3>
                <p class="text-muted">Customize which cookies you allow. Essential cookies are always enabled.</p>
            </div>
            <div class="card-body p-4">
                <!-- essential (always on) -->
                <div class="cookie-option">
                    <span><i class="fa-regular fa-shield me-2" style="color: var(--primary-deep);"></i>Essential cookies</span>
                    <div class="d-flex align-items-center gap-2">
                        <span class="badge bg-secondary">always active</span>
                    </div>
                </div>
                <!-- analytics toggle -->
                <div class="cookie-option" id="analyticsOption">
                    <span><i class="fa-regular fa-chart-bar me-2" style="color: var(--primary-deep);"></i>Analytics cookies (Google Analytics)</span>
                    <div class="cookie-switch" id="analyticsSwitch" role="button" tabindex="0"></div>
                </div>
                <!-- preferences toggle -->
                <div class="cookie-option" id="preferencesOption">
                    <span><i class="fa-regular fa-star me-2" style="color: var(--primary-deep);"></i>Preference cookies (language, theme)</span>
                    <div class="cookie-switch active" id="preferencesSwitch" role="button" tabindex="0"></div>
                </div>
                <!-- marketing (placeholder) -->
                <div class="cookie-option text-muted" style="opacity:0.6;">
                    <span><i class="fa-regular fa-bullhorn me-2"></i>Marketing cookies</span>
                    <span class="badge bg-light text-dark">not used</span>
                </div>

                <div class="alert alert-light small mt-3">
                    <i class="fa-regular fa-circle-info me-2"></i> Your preferences are saved in your browser for one year.
                </div>

                <div class="d-flex justify-content-end gap-2 mt-4">
                    <button type="button" class="btn btn-outline-secondary rounded-pill px-4" id="closeCookieConfig"><i class="fa-regular fa-xmark me-2"></i>Cancel</button>
                    <button type="button" class="btn btn-success rounded-pill px-4" id="saveCookieConfig"><i class="fa-regular fa-floppy-disk me-2"></i>Save preferences</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="modern-footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <h5><i class="fa-regular fa-compass me-2"></i>Yapei Community</h5>
                    <p class="small opacity-75">Connecting residents, sharing stories, building together.</p>
                </div>
                <div class="col-md-4">
                    <h5><i class="fa-regular fa-link"></i> Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="index.html" class="text-white text-decoration-none opacity-75"><i class="fa-solid fa-home me-2"></i>Home</a></li>
                        <li><a href="about.html" class="text-white text-decoration-none opacity-75"><i class="fa-solid fa-circle-info me-2"></i>About</a></li>
                        <li><a href="blog.html" class="text-white text-decoration-none opacity-75"><i class="fa-solid fa-newspaper me-2"></i>Blog</a></li>
                        <li><a href="privacy.html" class="text-white text-decoration-none opacity-75"><i class="fa-regular fa-shield me-2"></i>Privacy</a></li>
                        <li><a href="cookies.html" class="text-white text-decoration-none opacity-75"><i class="fa-regular fa-cookie-bite me-2"></i>Cookies</a></li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h5><i class="fa-regular fa-message"></i> Connect</h5>
                    <a href="#" class="text-white me-3 fs-5"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="text-white me-3 fs-5"><i class="fab fa-whatsapp"></i></a>
                    <a href="#" class="text-white fs-5"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
            <hr class="light mt-4">
            <p class="text-center small mb-0 opacity-75"><i class="fa-regular fa-copyright me-1"></i>2026 Yapei Community Online. All voices matter.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const BACKEND_URL = 'https://yapeionline.pythonanywhere.com';

        // Navbar dynamic links (login/logout)
        function updateNavbarLinks() {
            const userLinks = document.getElementById('navbar-user-links');
            if (!userLinks) return;
            const isLoggedIn = !!localStorage.getItem('access');
            userLinks.innerHTML = isLoggedIn
                ? `<li class="nav-item"><a class="nav-link" href="profile.html"><i class="fa-solid fa-circle-user me-1"></i>Profile</a></li>
                   <li class="nav-item"><a class="nav-link" href="logout.html"><i class="fa-solid fa-right-from-bracket me-1"></i>Logout</a></li>`
                : `<li class="nav-item"><a class="nav-link" href="login.html"><i class="fa-solid fa-arrow-right-to-bracket me-1"></i>Login</a></li>
                   <li class="nav-item"><a class="nav-link" href="register.html"><i class="fa-solid fa-user-plus me-1"></i>Register</a></li>`;
        }
        document.addEventListener('DOMContentLoaded', updateNavbarLinks);

        // ========== COOKIE CONFIGURATION POPUP (standalone) ==========
        const cookieOverlay = document.getElementById('cookieConfigOverlay');
        const cookiePopup = document.getElementById('cookieConfigPopup');
        const openCookieBtn = document.getElementById('openCookieConfig');
        const closeCookieBtn = document.getElementById('closeCookieConfig');
        const saveCookieBtn = document.getElementById('saveCookieConfig');

        // Toggle switches
        const analyticsSwitch = document.getElementById('analyticsSwitch');
        const preferencesSwitch = document.getElementById('preferencesSwitch');

        // Initialize toggle states from localStorage (if previously saved)
        function loadCookieSettings() {
            const analytics = localStorage.getItem('cookie_analytics') !== 'false'; // default true
            const preferences = localStorage.getItem('cookie_preferences') !== 'false'; // default true
            if (!analytics) analyticsSwitch.classList.remove('active');
            else analyticsSwitch.classList.add('active');
            if (!preferences) preferencesSwitch.classList.remove('active');
            else preferencesSwitch.classList.add('active');
        }
        loadCookieSettings();

        // Toggle click handlers
        analyticsSwitch.addEventListener('click', function(e) {
            e.preventDefault();
            this.classList.toggle('active');
        });
        preferencesSwitch.addEventListener('click', function(e) {
            e.preventDefault();
            this.classList.toggle('active');
        });

        // Open popup
        if (openCookieBtn) {
            openCookieBtn.addEventListener('click', function(e) {
                e.preventDefault();
                cookiePopup.style.display = 'block';
                cookieOverlay.style.display = 'block';
            });
        }

        function closeCookiePopup() {
            cookiePopup.classList.add('animate__fadeOutUp');
            cookieOverlay.style.display = 'none';
            setTimeout(() => { 
                cookiePopup.style.display = 'none'; 
                cookiePopup.classList.remove('animate__fadeOutUp'); 
            }, 300);
        }

        if (closeCookieBtn) {
            closeCookieBtn.addEventListener('click', closeCookiePopup);
            cookieOverlay.addEventListener('click', closeCookiePopup);
        }

        // Save preferences
        if (saveCookieBtn) {
            saveCookieBtn.addEventListener('click', function() {
                const analyticsEnabled = analyticsSwitch.classList.contains('active');
                const preferencesEnabled = preferencesSwitch.classList.contains('active');
                localStorage.setItem('cookie_analytics', analyticsEnabled);
                localStorage.setItem('cookie_preferences', preferencesEnabled);
                // In a real implementation you would also push these settings to your analytics lib
                alert('‚úÖ Cookie preferences saved!');
                closeCookiePopup();
            });
        }
    </script>
    <style>
        .btn-primary-custom {
            background: var(--primary-deep);
            border-radius: 60px;
            padding: 0.7rem 2.2rem;
            font-weight: 600;
            box-shadow: 0 8px 16px -6px #0a4d8c80;
            color: white;
            border: none;
        }
        .btn-primary-custom:hover {
            background: #135f94;
            transform: scale(1.02);
        }
        .bg-soft { background: var(--primary-soft); }
    </style>
</body>
</html>
